{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { Form, Message, Input, Card, Button, Grid } from 'semantic-ui-react';\nimport Layout from '../components/Layout';\nimport { Link } from '../routes';\nimport contract from '../ethereum/MagicIDContract';\nimport web3 from '../ethereum/web3';\n\nvar Home = /*#__PURE__*/function (_Component) {\n  _inherits(Home, _Component);\n\n  var _super = _createSuper(Home);\n\n  function Home() {\n    var _this;\n\n    _classCallCheck(this, Home);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      agencyID: '',\n      isActive: 'true',\n      setAccessMessage: '',\n      setAccessButton: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setAccess\", /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var accounts;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n\n                _this.setState({\n                  setAccessButton: true,\n                  setAccessMessage: ''\n                });\n\n                _context.prev = 2;\n                debugger;\n                _context.next = 6;\n                return web3.eth.getAccounts();\n\n              case 6:\n                accounts = _context.sent;\n                _context.next = 9;\n                return contract.methods.setAgencyAccess(web3.utils.fromAscii(_this.state.agencyID), Boolean(_this.state.isActive)).send({\n                  from: accounts[0]\n                });\n\n              case 9:\n                _context.next = 14;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](2);\n\n                _this.setState({\n                  setAccessMessage: _context.t0.message\n                });\n\n              case 14:\n                _this.setState({\n                  setAccessButton: false,\n                  agencyID: '',\n                  isActive: 'true'\n                });\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 11]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    return _this;\n  }\n\n  _createClass(Home, [{\n    key: \"renderMemberID\",\n    value: function renderMemberID() {\n      var items = this.props.allMemberID.map(function (uin) {\n        return {\n          header: uin,\n          style: {\n            overflowWrap: 'break-word',\n            border: '1px dashed blue'\n          }\n        };\n      });\n      return __jsx(Card.Group, {\n        items: items\n      });\n    }\n  }, {\n    key: \"renderAgencyID\",\n    value: function renderAgencyID() {\n      var items = this.props.allAgencyID.map(function (agencyID) {\n        return {\n          header: agencyID,\n          style: {\n            overflowWrap: 'break-word',\n            border: '1px dashed green'\n          }\n        };\n      });\n      return __jsx(Card.Group, {\n        items: items\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(Layout, {\n        activePage: \"index\"\n      }, __jsx(\"h3\", null, \" Set Agency Active \"), __jsx(Form, {\n        onSubmit: this.setAccess,\n        error: !!this.state.setAccessMessage\n      }, __jsx(Form.Group, {\n        inline: true\n      }, __jsx(\"label\", null, \"Set access to agency\"), __jsx(Input, {\n        style: {\n          width: \"20%\"\n        },\n        value: this.state.agencyID,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            agencyID: event.target.value\n          });\n        }\n      }), __jsx(\"label\", {\n        style: {\n          marginLeft: '10px'\n        }\n      }, \"Set(true) or Withdraw(false) Access\"), __jsx(Form.Radio, {\n        label: \"True\",\n        value: \"true\",\n        checked: this.state.isActive == 'true',\n        onChange: function onChange(event, _ref2) {\n          var value = _ref2.value;\n\n          _this2.setState({\n            isActive: value\n          });\n        }\n      }), __jsx(Form.Radio, {\n        label: \"False\",\n        value: \"false\",\n        checked: this.state.isActive == 'false',\n        onChange: function onChange(event, _ref3) {\n          var value = _ref3.value;\n\n          _this2.setState({\n            isActive: value\n          });\n        }\n      })), __jsx(Button, {\n        loading: this.state.setAccessButton,\n        primary: true\n      }, \"Set Access\"), __jsx(Message, {\n        error: true,\n        header: \"Oops!\",\n        content: this.state.setAccessMessage\n      }), __jsx(\"br\", null), \" \", __jsx(\"br\", null)), __jsx(Grid, null, __jsx(Grid.Row, null, __jsx(Grid.Column, {\n        width: 8\n      }, __jsx(\"h3\", null, \" Member IDs\"), __jsx(\"div\", null, this.renderMemberID())), __jsx(Grid.Column, {\n        width: 8\n      }, __jsx(\"h3\", null, \" Agency IDs\"), __jsx(\"div\", null, this.renderAgencyID())))));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var memberCount, agencyCount, allMemberID, allAgencyID;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return contract.methods.getMemberCount().call();\n\n              case 2:\n                memberCount = _context2.sent;\n                _context2.next = 5;\n                return contract.methods.getAgencyCount().call();\n\n              case 5:\n                agencyCount = _context2.sent;\n                _context2.next = 8;\n                return Promise.all(Array(parseInt(memberCount)).fill().map(function (element, index) {\n                  return contract.methods.uinArray(index).call();\n                }));\n\n              case 8:\n                allMemberID = _context2.sent;\n                _context2.next = 11;\n                return Promise.all(Array(parseInt(agencyCount)).fill().map(function (element, index) {\n                  return contract.methods.AccessAgencyArray(index).call();\n                }));\n\n              case 11:\n                allAgencyID = _context2.sent;\n                return _context2.abrupt(\"return\", {\n                  allMemberID: allMemberID,\n                  allAgencyID: allAgencyID\n                });\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function getInitialProps() {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return Home;\n}(Component);\n\nexport default Home;","map":{"version":3,"sources":["/Users/ayushgupta/Downloads/Personal/IdentifyMe-Blockchain/pages/index.js"],"names":["React","Component","Form","Message","Input","Card","Button","Grid","Layout","Link","contract","web3","Home","agencyID","isActive","setAccessMessage","setAccessButton","event","preventDefault","setState","eth","getAccounts","accounts","methods","setAgencyAccess","utils","fromAscii","state","Boolean","send","from","message","items","props","allMemberID","map","uin","header","style","overflowWrap","border","allAgencyID","setAccess","width","target","value","marginLeft","renderMemberID","renderAgencyID","getMemberCount","call","memberCount","getAgencyCount","agencyCount","Promise","all","Array","parseInt","fill","element","index","uinArray","AccessAgencyArray"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport { Form, Message, Input, Card, Button, Grid } from 'semantic-ui-react';\nimport Layout from '../components/Layout';\nimport { Link } from '../routes';\nimport contract from '../ethereum/MagicIDContract';\nimport web3 from '../ethereum/web3';\n\nclass Home extends Component{\n\n  state = {\n      agencyID: '',\n      isActive: 'true',\n      setAccessMessage: '',\n      setAccessButton: false\n    }\n\n  static async getInitialProps() {\n    const memberCount = await contract.methods.getMemberCount().call();\n    const agencyCount = await contract.methods.getAgencyCount().call();\n    const allMemberID = await Promise.all(\n      Array(parseInt(memberCount)).fill()\n      .map(\n        (element, index) => {\n          return contract.methods.uinArray(index).call();\n        })\n      );\n    const allAgencyID = await Promise.all(\n      Array(parseInt(agencyCount)).fill()\n      .map(\n        (element, index) => {\n          return contract.methods.AccessAgencyArray(index).call();\n        })\n      );\n    return { allMemberID, allAgencyID };\n  }\n\n  renderMemberID(){\n    const items = this.props.allMemberID.map(uin => {\n      return {\n        header: uin,\n        style: { overflowWrap: 'break-word', border: '1px dashed blue' }\n      };\n    });\n\n    return <Card.Group items={items} />;\n  }\n\n  renderAgencyID(){\n    const items = this.props.allAgencyID.map(agencyID => {\n      return {\n        header: agencyID,\n        style: { overflowWrap: 'break-word', border: '1px dashed green' }\n      };\n    });\n    return <Card.Group items={items} />;\n  }\n\n  setAccess = async (event) => {\n    event.preventDefault();\n    this.setState({setAccessButton: true, setAccessMessage: ''});\n\n    try {\n        debugger;\n       const accounts = await web3.eth.getAccounts();\n       await contract.methods.setAgencyAccess(web3.utils.fromAscii(this.state.agencyID), Boolean(this.state.isActive)).send({ from: accounts[0] });\n    } catch (err) {\n        this.setState({setAccessMessage: err.message});\n    }\n    this.setState({setAccessButton: false, agencyID: '', isActive: 'true' });\n  }\n\n  render(){\n      return(\n        <Layout activePage=\"index\">\n        <h3> Set Agency Active </h3>\n        <Form onSubmit={this.setAccess} error={!!this.state.setAccessMessage}>\n          <Form.Group inline>\n            <label>Set access to agency</label>\n            <Input style={{ width: \"20%\" }}\n              value={this.state.agencyID}\n              onChange={event => this.setState({ agencyID: event.target.value})}\n             />\n             <label style={{marginLeft:'10px'}}>Set(true) or Withdraw(false) Access</label>\n             <Form.Radio label='True' value='true' checked={this.state.isActive == 'true'} onChange={(event, {value}) => { this.setState({ isActive: value})} } />\n             <Form.Radio label='False' value='false' checked={this.state.isActive == 'false'} onChange={(event, {value}) => { this.setState({ isActive: value})} } />\n          </Form.Group>\n          <Button loading={this.state.setAccessButton} primary>Set Access</Button>\n          <Message error header=\"Oops!\" content={this.state.setAccessMessage} />\n          <br/> <br/>\n        </Form>\n        <Grid>\n          <Grid.Row>\n            <Grid.Column width={8}>\n              <h3> Member IDs</h3>\n              <div>\n                {this.renderMemberID()}\n              </div>\n            </Grid.Column>\n\n            <Grid.Column width={8}>\n              <h3> Agency IDs</h3>\n              <div>\n                {this.renderAgencyID()}\n              </div>\n            </Grid.Column>\n          </Grid.Row>\n\n        </Grid>\n        </Layout>\n      );\n  }\n\n}\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}